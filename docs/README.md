# GraphMemory 插件文档

## 文档说明

本目录包含 GraphMemory 插件的完整设计和使用文档。

## 当前版本

**v0.5.0** - WebUI 完整实现版本

## 文档列表

### 设计文档

#### 00-设计总览.md
**概述文档**，包含整个重新设计的摘要和导航。

**内容**:
- 设计背景和目标
- 核心改进对比
- 技术栈选择
- 开发计划 (已完成 WebUI 阶段)
- 风险和挑战

**适合**: 快速了解整体设计

---

#### 01-现有功能分析.md
**问题分析文档**，详细分析旧版本 (v0.2.0) 的功能和存在的问题。

**内容**:
- 插件概述
- 核心功能模块分析
- 工作流程梳理
- 主要问题总结
- 改进方向

**适合**: 理解为什么需要重新设计

---

#### 02-AstrBot接口分析.md
**接口文档**，梳理 AstrBot 提供的核心接口和插件开发规范。

**内容**:
- 插件基础架构
- Context 核心接口
- 事件过滤器 (Filter)
- AstrMessageEvent
- StarTools 工具类
- 配置 Schema
- 插件开发最佳实践

**适合**: 了解 AstrBot 插件开发能力

---

#### 03-新架构设计.md
**核心设计文档**，详细设计新的插件架构、Schema 和核心模块。

**内容**:
- 设计目标和原则
- 新架构概览
- 简化的 Schema 设计
- 核心模块设计
- 功能特性
- 配置简化
- 性能优化

**适合**: 理解新架构的设计思路

---

#### 04-接口设计.md
**API 文档**，定义前后端 API 接口规范。

**内容**:
- 接口概览
- 图谱数据接口
- 实体管理接口
- 关系管理接口
- 搜索功能接口
- 统计分析接口
- 系统管理接口
- 错误码定义

**适合**: 前后端开发人员参考

---

#### 05-前端设计.md
**前端文档**，设计前端界面和交互流程。

**内容**:
- 技术栈选择
- 页面结构
- 页面详细设计
- 组件设计
- 交互流程
- 响应式设计
- 性能优化

**适合**: 前端开发人员参考

---

#### 06-人格与记忆设计.md
**人格策略文档**，设计人格切换时的记忆共享策略。

**内容**:
- AstrBot 人格机制
- 旧版本人格处理分析
- 记忆共享策略对比
- 推荐方案: 分层共享
- 实现细节

**适合**: 理解人格与记忆的关系

---

### 使用文档

#### WebUI使用指南.md
**WebUI 使用手册**，详细说明 WebUI 的功能和使用方法。

**内容**:
- 技术栈介绍
- 启动和配置
- 功能说明 (登录、图谱、实体、关系、搜索、统计、系统)
- 主题切换
- 性能优化
- 故障排除
- 开发说明

**适合**: WebUI 用户和开发者

---

#### 更新说明.md
**版本更新记录**，记录各版本的更新内容。

**适合**: 了解版本变化

---

## 阅读顺序

### 用户使用
1. **WebUI使用指南.md** - 学习如何使用 WebUI
2. **更新说明.md** - 了解最新功能

### 快速了解
1. **00-设计总览.md** - 快速了解整体设计

### 深入理解
1. **01-现有功能分析.md** - 理解问题
2. **02-AstrBot接口分析.md** - 了解能力
3. **03-新架构设计.md** - 理解方案
4. **06-人格与记忆设计.md** - 理解人格策略

### 开发实施
1. **03-新架构设计.md** - 后端架构
2. **06-人格与记忆设计.md** - 人格实现
3. **04-接口设计.md** - API 规范
4. **05-前端设计.md** - 前端实现
5. **WebUI使用指南.md** - WebUI 开发

## 关键改进总结

### 架构简化
- 记忆层次: 3层 → 2层
- 配置项: 20+ → 14
- Schema 节点: 5种 → 3种
- Schema 关系: 7种 → 4种
- 人格策略: 未实现 → 分层共享

### 性能优化
- 异步并发处理
- 减少 LLM 调用次数
- 缓存策略
- 批量操作

### 功能增强
- 主动记忆检索 (Function Calling)
- 实体消歧和合并
- 时间衰减机制
- 人格分层共享策略
- 完整的 WebUI ✅

## 开发进度

### ✅ 第一阶段: 核心功能
- [x] 简化 Schema 实现
- [x] 核心模块开发
- [x] 基础指令系统

### ✅ 第二阶段: 高级功能
- [x] 实体管理
- [x] 关系管理
- [x] 主动检索
- [x] 性能优化

### ✅ 第三阶段: WebUI
- [x] FastAPI 后端
- [x] Vue 3 前端框架
- [x] 图谱可视化 (Cytoscape.js)
- [x] 实体/关系管理界面
- [x] 搜索测试界面 (混合/向量/关键词)
- [x] 统计分析界面 (ECharts 图表)
- [x] 系统管理 (导入/导出/清理)

### 🔄 第四阶段: 测试和优化
- [ ] 单元测试
- [ ] 集成测试
- [ ] 文档完善
- [ ] Bug 修复

## WebUI 功能特性

### 已实现功能
- ✅ 图谱可视化 (Cytoscape.js)
  - 会话图谱和全局图谱切换
  - 节点大小表示重要性
  - 边宽度表示关系强度
  - 拖拽、缩放、搜索

- ✅ 实体管理
  - 列表、搜索、过滤
  - 查看详情、编辑、删除
  - 分页浏览

- ✅ 关系管理
  - 列表、过滤
  - 删除关系
  - 分页浏览

- ✅ 搜索测试
  - 混合搜索
  - 向量搜索
  - 关键词搜索

- ✅ 统计分析
  - 概览卡片
  - 实体类型分布饼图 (ECharts)
  - 实体创建趋势折线图 (ECharts)

- ✅ 系统管理
  - 系统状态查看
  - 图谱导出 (JSON)
  - 图谱导入 (合并/覆盖)
  - 清理低重要性实体
  - 应用时间衰减

- ✅ 主题切换
  - 明暗主题
  - 纯色设计，无渐变
  - 图表自动适配

## 技术栈

### 后端
- Python 3.10+
- KuzuDB (图数据库)
- SQLite (缓冲区)
- FastAPI (WebUI 后端)
- Uvicorn (ASGI 服务器)

### 前端
- Vue 3 (Composition API)
- TypeScript
- Vite
- Cytoscape.js (图谱可视化)
- ECharts (统计图表)
- Axios (HTTP 客户端)

## 联系方式

如有疑问或建议，请联系:
- **作者**: lxfight
- **项目**: astrbot_plugin_GraphMemory
- **当前版本**: v0.5.0

---

**文档版本**: 2.0
**最后更新**: 2025-12-18
**状态**: WebUI 已完成
